const PC2=[13,16,10,23,0,4,2,27,14,5,20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31],totrot=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],z=0;let a,b,c,d,e,f;a=65536,b=1<<24,c=a|b,d=4,e=1024,f=d|e;const SP1=[c|e,0,0|a,c|f,c|d,a|f,0|d,0|a,0|e,c|e,c|f,0|e,b|f,c|d,0|b,0|d,0|f,b|e,b|e,a|e,a|e,0|c,0|c,b|f,a|d,b|d,b|d,a|d,0,0|f,a|f,0|b,0|a,c|f,0|d,0|c,c|e,0|b,0|b,0|e,c|d,0|a,a|e,b|d,0|e,0|d,b|f,a|f,c|f,a|d,0|c,b|f,b|d,0|f,a|f,c|e,0|f,b|e,b|e,0,a|d,a|e,0,c|d];a=1<<20,b=1<<31,c=a|b,d=32,e=32768,f=d|e;const SP2=[c|f,b|e,0|e,a|f,0|a,0|d,c|d,b|f,b|d,c|f,c|e,0|b,b|e,0|a,0|d,c|d,a|e,a|d,b|f,0,0|b,0|e,a|f,0|c,a|d,b|d,0,a|e,0|f,c|e,0|c,0|f,0,a|f,c|d,0|a,b|f,0|c,c|e,0|e,0|c,b|e,0|d,c|f,a|f,0|d,0|e,0|b,0|f,c|e,0|a,b|d,a|d,b|f,b|d,a|d,a|e,0,b|e,0|f,0|b,c|d,c|f,a|e];a=1<<17,b=1<<27,c=a|b,d=8,e=512,f=d|e;const SP3=[0|f,c|e,0,c|d,b|e,0,a|f,b|e,a|d,b|d,b|d,0|a,c|f,a|d,0|c,0|f,0|b,0|d,c|e,0|e,a|e,0|c,c|d,a|f,b|f,a|e,0|a,b|f,0|d,c|f,0|e,0|b,c|e,0|b,a|d,0|f,0|a,c|e,b|e,0,0|e,a|d,c|f,b|e,b|d,0|e,0,c|d,b|f,0|a,0|b,c|f,0|d,a|f,a|e,b|d,0|c,b|f,0|f,0|c,a|f,0|d,c|d,a|e];a=8192,b=1<<23,c=a|b,d=1,e=128,f=d|e;const SP4=[c|d,a|f,a|f,0|e,c|e,b|f,b|d,a|d,0,0|c,0|c,c|f,0|f,0,b|e,b|d,0|d,0|a,0|b,c|d,0|e,0|b,a|d,a|e,b|f,0|d,a|e,b|e,0|a,c|e,c|f,0|f,b|e,b|d,0|c,c|f,0|f,0,0,0|c,a|e,b|e,b|f,0|d,c|d,a|f,a|f,0|e,c|f,0|f,0|d,0|a,b|d,a|d,c|e,b|f,a|d,a|e,0|b,c|d,0|e,0|b,0|a,c|e];a=1<<25,b=1<<30,c=a|b,d=256,e=1<<19,f=d|e;const SP5=[0|d,a|f,a|e,c|d,0|e,0|d,0|b,a|e,b|f,0|e,a|d,b|f,c|d,c|e,0|f,0|b,0|a,b|e,b|e,0,b|d,c|f,c|f,a|d,c|e,b|d,0,0|c,a|f,0|a,0|c,0|f,0|e,c|d,0|d,0|a,0|b,a|e,c|d,b|f,a|d,0|b,c|e,a|f,b|f,0|d,0|a,c|e,c|f,0|f,0|c,c|f,a|e,0,b|e,0|c,0|f,a|d,b|d,0|e,0,b|e,a|f,b|d];a=1<<22,b=1<<29,c=a|b,d=16,e=16384,f=d|e;const SP6=[b|d,0|c,0|e,c|f,0|c,0|d,c|f,0|a,b|e,a|f,0|a,b|d,a|d,b|e,0|b,0|f,0,a|d,b|f,0|e,a|e,b|f,0|d,c|d,c|d,0,a|f,c|e,0|f,a|e,c|e,0|b,b|e,0|d,c|d,a|e,c|f,0|a,0|f,b|d,0|a,b|e,0|b,0|f,b|d,c|f,a|e,0|c,a|f,c|e,0,c|d,0|d,0|e,0|c,a|f,0|e,a|d,b|f,0,c|e,0|b,a|d,b|f];a=1<<21,b=1<<26,c=a|b,d=2,e=2048,f=d|e;const SP7=[0|a,c|d,b|f,0,0|e,b|f,a|f,c|e,c|f,0|a,0,b|d,0|d,0|b,c|d,0|f,b|e,a|f,a|d,b|e,b|d,0|c,c|e,a|d,0|c,0|e,0|f,c|f,a|e,0|d,0|b,a|e,0|b,a|e,0|a,b|f,b|f,c|d,c|d,0|d,a|d,0|b,b|e,0|a,c|e,0|f,a|f,c|e,0|f,b|d,c|f,0|c,a|e,0,0|d,c|f,0,a|f,0|c,0|e,b|d,b|e,0|e,a|d];a=1<<18,b=1<<28,c=a|b,d=64,e=4096,f=d|e;const SP8=[b|f,0|e,0|a,c|f,0|b,b|f,0|d,0|b,a|d,0|c,c|f,a|e,c|e,a|f,0|e,0|d,0|c,b|d,b|e,0|f,a|e,a|d,c|d,c|e,0|f,0,0,c|d,b|d,b|e,a|f,0|a,a|f,0|a,c|e,0|e,0|d,c|d,0|e,a|f,b|e,0|d,b|d,0|c,c|d,0|b,0|a,b|f,0,c|f,a|d,b|d,0|c,b|e,b|f,0,c|f,a|e,a|e,0|f,0|f,a|d,0|b,c|e];export default class DES{constructor(password){this.keys=[];const pc1m=[],pcr=[],kn=[];for(let j=0,l=56;j<56;++j,l-=8){l+=l<-5?65:l<-3?31:l<-1?63:27===l?35:0;const m=7&l;pc1m[j]=0!=(password[l>>>3]&1<<m)?1:0}for(let i=0;i<16;++i){const m=i<<1,n=m+1;kn[m]=kn[n]=0;for(let o=28;o<59;o+=28)for(let j=o-28;j<o;++j){const l=j+totrot[i];pcr[j]=l<o?pc1m[l]:pc1m[l-28]}for(let j=0;j<24;++j)0!==pcr[PC2[j]]&&(kn[m]|=1<<23-j),0!==pcr[PC2[j+24]]&&(kn[n]|=1<<23-j)}for(let i=0,rawi=0,KnLi=0;i<16;++i){const raw0=kn[rawi++],raw1=kn[rawi++];this.keys[KnLi]=(16515072&raw0)<<6,this.keys[KnLi]|=(4032&raw0)<<10,this.keys[KnLi]|=(16515072&raw1)>>>10,this.keys[KnLi]|=(4032&raw1)>>>6,++KnLi,this.keys[KnLi]=(258048&raw0)<<12,this.keys[KnLi]|=(63&raw0)<<16,this.keys[KnLi]|=(258048&raw1)>>>4,this.keys[KnLi]|=63&raw1,++KnLi}}enc8(text){const b=text.slice();let i=0,l,r,x;l=b[i++]<<24|b[i++]<<16|b[i++]<<8|b[i++],r=b[i++]<<24|b[i++]<<16|b[i++]<<8|b[i++],x=252645135&(l>>>4^r),r^=x,l^=x<<4,x=65535&(l>>>16^r),r^=x,l^=x<<16,x=858993459&(r>>>2^l),l^=x,r^=x<<2,x=16711935&(r>>>8^l),l^=x,r^=x<<8,r=r<<1|r>>>31&1,x=2863311530&(l^r),l^=x,r^=x,l=l<<1|l>>>31&1;for(let i=0,keysi=0;i<8;++i){x=r<<28|r>>>4,x^=this.keys[keysi++];let fval=SP7[63&x];fval|=SP5[x>>>8&63],fval|=SP3[x>>>16&63],fval|=SP1[x>>>24&63],x=r^this.keys[keysi++],fval|=SP8[63&x],fval|=SP6[x>>>8&63],fval|=SP4[x>>>16&63],fval|=SP2[x>>>24&63],l^=fval,x=l<<28|l>>>4,x^=this.keys[keysi++],fval=SP7[63&x],fval|=SP5[x>>>8&63],fval|=SP3[x>>>16&63],fval|=SP1[x>>>24&63],x=l^this.keys[keysi++],fval|=SP8[63&x],fval|=SP6[x>>>8&63],fval|=SP4[x>>>16&63],fval|=SP2[x>>>24&63],r^=fval}for(r=r<<31|r>>>1,x=2863311530&(l^r),l^=x,r^=x,l=l<<31|l>>>1,x=16711935&(l>>>8^r),r^=x,l^=x<<8,x=858993459&(l>>>2^r),r^=x,l^=x<<2,x=65535&(r>>>16^l),l^=x,r^=x<<16,x=252645135&(r>>>4^l),l^=x,r^=x<<4,x=[r,l],i=0;i<8;i++)b[i]=(x[i>>>2]>>>8*(3-i%4))%256,b[i]<0&&(b[i]+=256);return b}encrypt(t){return this.enc8(t.slice(0,8)).concat(this.enc8(t.slice(8,16)))}}