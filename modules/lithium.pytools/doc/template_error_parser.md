# C++ Template Error Analyzer Documentation

This document provides a comprehensive guide on how to use the **C++ Template Error Analyzer**. This Python script helps developers analyze and visualize complex C++ template errors generated by compilers like GCC, Clang, or MSVC. It parses error logs, suggests fixes, extracts relevant code context, and visualizes error hierarchies using Graphviz.

---

## Key Features

1. **Error Parsing**: Identifies main errors, nested template instantiation errors, and key details like "no matching function" or "substitution failure".
2. **Suggestions**: Generates suggestions for common error patterns, helping users address issues quickly.
3. **Code Context Extraction**: Automatically extracts and highlights relevant lines of code from the source file where the error occurred.
4. **Error Visualization**: Creates a visual representation of the error hierarchy using Graphviz, showing relationships between template instantiations.
5. **File Handling**: Supports downloading error log files from a URL and decompressing gzip files.
6. **Error Information Export**: Saves parsed error details to a JSON file for later review or integration with other tools.

---

## Requirements

- Python 3.6 or higher.
- Required libraries: `requests`, `termcolor`, `graphviz`, `argparse`.

Install the required libraries using pip:

```bash
pip install requests termcolor graphviz argparse
```

For Graphviz rendering, ensure that the Graphviz command-line tools are installed and available in your system's PATH. You can download Graphviz from: [Graphviz Download](https://graphviz.org/download/).

---

## Usage

The script can be executed from the command line with various options for different actions. The command syntax is as follows:

```bash
python error_analyzer.py <action> [options]
```

### Basic Example

To analyze an error log file and generate a visual error tree:

```bash
python error_analyzer.py error_log.txt --graph error_tree --format png --view
```

This will:

- Parse the `error_log.txt` file to extract error information.
- Save the parsed information as `parsed_error.json`.
- Generate an error tree visualization (`error_tree.png`).
- Open the generated image for viewing if the `--view` flag is provided.

### Extract Code Context

To extract the source code lines around the error:

```bash
python error_analyzer.py error_log.txt --context 5
```

This will:

- Parse the `error_log.txt` file.
- Extract 5 lines of code before and after the error location and display them.

### Download and Analyze

If the error log is hosted online, you can download it first and then analyze:

```bash
python error_analyzer.py downloaded_log.txt --download http://example.com/error_log.txt
```

This will:

- Download the error log file from the provided URL.
- Parse the error and save the results.

### Decompress and Analyze

To analyze a compressed (gzip) error log:

```bash
python error_analyzer.py decompressed_error.txt --decompress error_log.txt.gz
```

This will:

- Decompress `error_log.txt.gz` and save it as `decompressed_error.txt`.
- Parse the decompressed error log.

---

## Available Command-Line Options

```bash
usage: error_analyzer.py [-h] [--output OUTPUT] [--graph GRAPH]
                         [--compiler COMPILER] [--context CONTEXT]
                         [--download URL] [--decompress GZIP_FILE]
                         [--format FORMAT] [--view] [--no-save]
                         FILE

C++ Template Error Analyzer

positional arguments:
  FILE                  Path to the error log file

optional arguments:
  -h, --help            Show this help message and exit
  --output OUTPUT       Path to save parsed error info (default: "parsed_error.json")
  --graph GRAPH         Filename for error tree graph (default: "error_tree")
  --compiler COMPILER   Compiler type (gcc, clang, msvc) (default: gcc)
  --context CONTEXT     Number of context lines to extract around error line (default: 3)
  --download URL        URL to download the error log file
  --decompress GZIP_FILE
                        Path to the gzip file to decompress
  --format FORMAT       Format of the output graph file (e.g., 'png', 'pdf') (default: png)
  --view                Whether to open the generated graph file with the default viewer
  --no-save             Skip saving the generated graph file
```

---

## How the Script Works

1. **Error Parsing**: The script reads the provided error log file and matches common error patterns. It identifies the main error and nested instantiations, gathering details like mismatched types or failed substitutions.
2. **Code Context**: If a source file and line number are available in the error log, the script extracts lines around the error to provide context.
3. **Suggestions**: Based on the error details, the script generates suggestions such as checking template parameters or ensuring function signatures match.
4. **Error Tree Generation**: A visual representation of the error hierarchy is created using Graphviz. The main error is shown as the root, with nested template instantiations as child nodes. This graph can be saved in various formats (e.g., PNG, PDF) and viewed immediately if requested.
5. **Saving Output**: The parsed error information is saved to a JSON file, which can be used for further analysis or shared with other developers.

---

## Example Error

Suppose you have the following error log in `error_log.txt`:

```txt
main.cpp:15:10: error: no matching function for call to 'foo'
note: candidate function template not viable: no known conversion from 'int' to 'std::string' for 1st argument
```

Running the following command:

```bash
python error_analyzer.py error_log.txt --context 5 --graph error_tree --view
```

Will output:

- Parsed error details with suggestions like "Check the function signature and ensure template parameters match".
- A graphical error tree visualizing the error's structure.
- The code context around the line where the error occurred.

---

## Conclusion

The **C++ Template Error Analyzer** is a powerful tool for developers working with C++ templates. It simplifies the process of understanding and resolving complex template errors, providing detailed analysis, suggestions, and visualizations to enhance debugging and development efficiency. By following this documentation, users can effectively utilize the analyzer to improve their C++ coding experience.
